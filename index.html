<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BTS COMEBACK MISSION - HYUNG LINE EDITION</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chart.js is essential for analytics pages -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <!-- === Loading Overlay (Shown during API calls) === -->
    <div id="loading" class="loading-overlay">
        <div class="loader">
            <div class="loader-ring"></div>
            <div class="loader-ring"></div>
            <div class="loader-ring"></div>
            <p>ACCESSING DATABASE...</p>
        </div>
    </div>
    
    <!-- Login Screen -->
    <div id="login-screen" class="screen active">
        <div class="login-container">
            <div class="cyber-grid"></div>
            <div class="login-content">
                <div class="logo-section">
                    <div class="bts-logo">‚ü≠‚ü¨</div>
                    <h1 class="title">SPY BATTLE</h1>
                    <p class="subtitle">HYUNG LINE EDITION</p>
                    <div class="scan-line"></div>
                </div>

                <div class="login-box">
                    <div class="input-group">
                        <label>AGENT IDENTIFICATION</label>
                        <input type="text" id="agent-input" placeholder="Enter Agent Number..." autocomplete="off">
                        <button id="login-btn" class="btn-primary">
                            <span class="btn-glow"></span>
                            <span>ACCESS DASHBOARD</span>
                        </button>
                    </div>

                    <div class="divider"><span>OR</span></div>

                    <div class="input-group">
                        <label>INSTAGRAM LOOKUP</label>
                        <input type="text" id="instagram-input" placeholder="Enter Instagram username..." autocomplete="off">
                        <button id="find-btn" class="btn-secondary">FIND AGENT ID</button>
                    </div>

                    <div id="find-result" class="result-box"></div>
                </div>

                <div class="login-footer">
                    <div class="pulse-dot"></div>
                    <span>SECURE CONNECTION ESTABLISHED</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Dashboard Screen -->
    <div id="dashboard-screen" class="screen">
        <!-- Sidebar -->
        <aside id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <div class="logo-mini">‚ü≠‚ü¨</div>
                <span>SPY BATTLE</span>
                <button id="close-sidebar" class="close-btn">‚úï</button>
            </div>

            <div class="agent-card">
                <div class="agent-avatar" id="agent-avatar"></div>
                <div class="agent-details">
                    <div class="agent-name" id="agent-name">Agent</div>
                    <div class="agent-team" id="agent-team">Team</div>
                    <div class="agent-id" id="agent-id">ID: ---</div>
                </div>
            </div>

            <div class="week-selector">
                <label>üìÖ MISSION WEEK</label>
                <select id="week-select"></select>
            </div>

            <nav class="nav-menu">
                <a href="#" class="nav-link active" data-page="home">
                    <span class="nav-icon">üè†</span>
                    <span>Mission Control</span>
                </a>
                <a href="#" class="nav-link" data-page="profile">
                    <span class="nav-icon">üë§</span>
                    <span>Agent Profile</span>
                </a>
                <a href="#" class="nav-link" data-page="rankings">
                    <span class="nav-icon">üèÜ</span>
                    <span>Rankings</span>
                </a>
                <a href="#" class="nav-link" data-page="goals">
                    <span class="nav-icon">üéØ</span>
                    <span>Goals Progress</span>
                </a>
                <a href="#" class="nav-link" data-page="album2x">
                    <span class="nav-icon">üíø</span>
                    <span>Album 2X Check</span>
                </a>
                <a href="#" class="nav-link" data-page="team-level">
                    <span class="nav-icon">üìä</span>
                    <span>Team Levels</span>
                </a>
                <a href="#" class="nav-link" data-page="team-charts">
                    <span class="nav-icon">üìà</span>
                    <span>Team Charts</span>
                </a>
                <a href="#" class="nav-link" data-page="agent-charts">
                    <span class="nav-icon">üìâ</span>
                    <span>Agent Charts</span>
                </a>
                <a href="#" class="nav-link" data-page="comparison">
                    <span class="nav-icon">‚öîÔ∏è</span>
                    <span>Team Comparison</span>
                </a>
                <a href="#" class="nav-link" data-page="summary">
                    <span class="nav-icon">üìã</span>
                    <span>Weekly Summary</span>
                </a>
                <a href="#" class="nav-link" data-page="drawer">
                    <span class="nav-icon">üéñÔ∏è</span>
                    <span>My Drawer</span>
                </a>
                <a href="#" class="nav-link" data-page="announcements">
                    <span class="nav-icon">üì¢</span>
                    <span>Announcements</span>
                </a>
                <!-- Admin link will be dynamically added -->
            </nav>

            <div class="sidebar-footer">
                <div class="last-update">
                    Last Sync: <span id="last-update">--:--</span>
                </div>
                <button id="logout-btn" class="btn-logout">üö™ Logout</button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="mobile-header">
                <button id="menu-btn" class="menu-btn">‚ò∞</button>
                <div class="header-logo">‚ü≠‚ü¨ SPY BATTLE</div>
            </header>

            <!-- Pages -->
            <div class="pages-wrapper">
                
                <!-- HOME PAGE -->
                <section id="page-home" class="page active">
                    <div class="page-header">
                        <h1>Mission Control</h1>
                        <p id="current-week">Week: Loading...</p>
                    </div>

                    <div class="welcome-card">
                        <div class="welcome-icon">‚ü≠‚ü¨</div>
                        <h2>Welcome Back, <span id="agent-name-home">Agent</span></h2>
                        <p>Complete all 3 primary missions to level up your team!</p>
                    </div>

                    <div class="missions-grid" id="home-mission-grid">
                        <!-- Mission cards dynamically populated -->
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3>üèÜ Top Agents</h3>
                        </div>
                        <div class="card-body" id="home-top-agents">Loading...</div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3>üé≠ Team Standings</h3>
                        </div>
                        <div class="card-body" id="home-standings">Loading...</div>
                    </div>
                </section>

                <!-- PROFILE PAGE -->
                <section id="page-profile" class="page">
                    <div class="page-header">
                        <h1>Agent Profile</h1>
                    </div>

                    <div class="profile-card">
                        <div class="profile-avatar" id="profile-avatar"></div>
                        <div class="profile-info">
                            <h2 id="profile-name">Agent Name</h2>
                            <p id="profile-team">Team</p>
                            <p id="profile-id">Agent ID: ---</p>
                        </div>
                    </div>

                    <div class="stats-grid" id="profile-stats">Loading...</div>

                    <div class="card">
                        <div class="card-header"><h3>üéµ Track Streams</h3></div>
                        <div class="card-body" id="profile-tracks">Loading...</div>
                    </div>

                    <div class="card">
                        <div class="card-header"><h3>üíø Album Streams</h3></div>
                        <div class="card-body" id="profile-albums">Loading...</div>
                    </div>

                    <div class="card">
                        <div class="card-header"><h3>üéñÔ∏è Badges</h3></div>
                        <div class="card-body" id="profile-badges">No badges yet</div>
                    </div>
                </section>

                <!-- RANKINGS PAGE -->
                <section id="page-rankings" class="page">
                    <div class="page-header">
                        <h1>Rankings</h1>
                    </div>

                    <div class="filter-tabs" id="rankings-filter">
                        <button class="filter-btn active" data-filter="all">All</button>
                        <button class="filter-btn" data-filter="team">My Team</button>
                        <button class="filter-btn" data-filter="xp">XP</button>
                    </div>

                    <div class="card">
                        <div class="card-body" id="rankings-list">Loading...</div>
                    </div>
                </section>

                <!-- GOALS PAGE -->
                <section id="page-goals" class="page">
                    <div class="page-header">
                        <h1>Goals Progress</h1>
                    </div>
                    <div id="goals-content">Loading...</div>
                </section>

                <!-- ALBUM 2X PAGE -->
                <section id="page-album2x" class="page">
                    <div class="page-header">
                        <h1>Album 2X Mission</h1>
                        <p>Stream each track in your team album at least 2 times</p>
                    </div>
                    <div id="album2x-content">Loading...</div>
                </section>

                <!-- TEAM LEVEL PAGE -->
                <section id="page-team-level" class="page">
                    <div class="page-header">
                        <h1>Team Levels</h1>
                    </div>
                    <div id="team-level-content">Loading...</div>
                </section>

                <!-- TEAM CHARTS PAGE -->
                <section id="page-team-charts" class="page">
                    <div class="page-header">
                        <h1>Team Analytics</h1>
                    </div>
                    <div class="charts-grid">
                        <div class="card">
                            <div class="card-header"><h3>Team XP Comparison (Stream + Secret)</h3></div>
                            <div class="card-body"><canvas id="chart-team-xp"></canvas></div>
                        </div>
                        <div class="card">
                            <div class="card-header"><h3>Team Level Progression</h3></div>
                            <div class="card-body"><canvas id="chart-team-levels"></canvas></div>
                        </div>
                    </div>
                </section>

                <!-- AGENT CHARTS PAGE -->
                <section id="page-agent-charts" class="page">
                    <div class="page-header">
                        <h1>Your Analytics</h1>
                    </div>
                    <div class="charts-grid">
                        <div class="card">
                            <div class="card-header"><h3>Your Track Breakdown</h3></div>
                            <div class="card-body"><canvas id="chart-agent-tracks"></canvas></div>
                        </div>
                        <div class="card">
                            <div class="card-header"><h3>Your Album Breakdown</h3></div>
                            <div class="card-body"><canvas id="chart-agent-albums"></canvas></div>
                        </div>
                    </div>
                </section>

                <!-- COMPARISON PAGE -->
                <section id="page-comparison" class="page">
                    <div class="page-header">
                        <h1>Team Comparison</h1>
                    </div>
                    <div id="comparison-content">Loading...</div>
                </section>

                <!-- SUMMARY PAGE -->
                <section id="page-summary" class="page">
                    <div class="page-header">
                        <h1>Weekly Summary</h1>
                    </div>
                    <div id="summary-content">Loading...</div>
                </section>

                <!-- DRAWER PAGE -->
                <section id="page-drawer" class="page">
                    <div class="page-header">
                        <h1>My Drawer</h1>
                        <p>Badges & Achievements</p>
                    </div>
                    <div id="drawer-content">Loading...</div>
                </section>

                <!-- ANNOUNCEMENTS PAGE -->
                <section id="page-announcements" class="page">
                    <div class="page-header">
                        <h1>Announcements</h1>
                    </div>
                    <div id="announcements-content">Loading...</div>
                </section>
                
                <!-- SECRET MISSIONS PAGE (Requires Admin Auth) -->
                 <section id="page-secret-missions" class="page">
                    <div class="page-header">
                        <h1>Secret Mission Hub</h1>
                        <p>Tasks assigned by Command.</p>
                    </div>
                    <div id="secret-missions-content">Loading...</div>
                </section>

            </div>
        </main>
    </div>
    
    <!-- MODALS & OVERLAYS (Admin Modal, etc.) -->
    <!-- Admin Modal will be injected here -->

    <script src="app.js"></script>
</body>
</html>
